### 액세스 권한 체계 (구현 완료 ✅)

**계층 구조:** 
수퍼어드민 → 총괄관리자 → 조직/지점관리자 → 직원

**구현 상태**: 4-tier RBAC 시스템 완전 구현
- **데이터베이스**: PostgreSQL with RLS policies
- **백엔드**: Supabase Edge Functions with role mapping 
- **프론트엔드**: Role-based UI with permission-based navigation
- **API**: System admin endpoints with full CRUD operations

**시스템 역할:**
* **수퍼어드민** (`super_admin`): 회사의 최고 관리자 (CEO/사장)
* **총괄관리자** (`hr_admin`): 회사의 인사 담당자  
* **조직/지점관리자**: 조직 내 팀장/본부장 (결재 권한 보유)
* **직원** (`employee`): 일반 직원

---

### 권한 구분

1. **수퍼어드민** (`system_admin` in UI) ✅ **구현 완료**

   * 회사의 최고 관리자 (CEO, 사장급)
   * **시스템 전체 관리 권한**: 모든 기능 사용 가능
   * **구현된 기능**: 
     - 전체 직원 CRUD 관리 (`/system/users`)
     - 회사 정보 관리 (`/system/company`) 
     - 조직 구조 관리
     - 시스템 설정 관리
     - 모든 결재 권한
     - 통계 및 분석 대시보드

2. **총괄관리자** (`company_admin` in UI) ✅ **구현 완료**

   * 회사의 인사 담당자
   * **인사 관리 권한**: 직원 관리, 근무 관리, 승인 관리
   * **구현된 기능**:
     - 직원 관리 (생성, 수정, 상태 변경)
     - 근무 관리 (일정, 근무지, 정책)
     - 승인 관리 (휴가, 초과근무, 출장)
     - 보고서 및 분석 (출근 현황, 52시간 모니터링)

3. **조직/지점관리자** ✅ **구현 완료**

   * 조직 내 팀장, 본부장 등 (일반 직원이면서 결재 권한 보유)
   * **관리자 관계**: `manager_id` 기반 결재라인 구성
   * **결재 권한**: `approval_authorities` 테이블로 세부 권한 관리
   * **구현된 기능**:
     - 직속 부하 직원 관리
     - 휴가/초과근무 승인
     - 조직별 근태 현황 조회

4. **직원** (`employee` in UI) ✅ **구현 완료**

   * 일반 사용자
   * **기본 권한**: 개인 근태 관리, 휴가 신청, 출퇴근 체크
   * **구현된 기능**:
     - 개인 대시보드 (근무 현황)
     - 출퇴근 관리 (체크, 기록)
     - 휴가 관리 (신청, 내역 조회)
     - 개인 정보 관리

---

### 모든 권한에게 제공되는 기본 기능

(단, 수퍼어드민 설정에 따라 제한 가능)

* **근태 기록**

  * 출근/퇴근 기록 (모바일·PC)
  * 내 출퇴근 기록 열람
  * 내 근무일정 및 조직/지점 근무일정 열람

* **승인 요청**

  * 근무일정 생성/수정/삭제
  * 출퇴근기록 생성/수정
  * 휴가 생성/삭제

---

### 관리자 권한별 기능

| 관리 구분     | 기능       | 조직/지점관리자 | 총괄관리자 | 수퍼어드민 |
| --------- | -------- | -------- | ----- | ----- |
| **근무일정**  | 생성/수정/삭제 | ✔︎       | ✔︎    | ✔︎    |
|           | 확정       | ✔︎       | ✔︎    |       |
| **출퇴근기록** | 생성/수정/삭제 | ✔︎       | ✔︎    | ✔︎    |
|           | 확정       | ✔︎       | ✔︎    |       |
| **휴가**    | 생성/삭제    | ✔︎       | ✔︎    | ✔︎    |
|           | 발생 관리    |          | ✔︎    | ✔︎    |
|           | 유형 관리    |          | ✔︎    |       |
| **요청**    | 승인/거절    | ✔︎       | ✔︎    | ✔︎    |
|           | 승인 규칙 관리 |          | ✔︎    |       |
| **조직/지점** | 수정       | ✔︎       | ✔︎    | ✔︎    |
|           | 관리       | ✔︎       | ✔︎    |       |
| **직원 관리** | 직원/직무 관리 | ✔︎       | ✔︎    | ✔︎    |
| **회사 설정** | 설정 전체    |          |       | ✔︎    |

※ 조직/지점관리자의 권한은 수퍼어드민 설정에 따라 제한될 수 있음

---

## 구현 상세 정보 (Implementation Details) ✅

### 데이터베이스 구현
- **테이블 구조**: `employees`, `companies`, `organizations` 테이블 완성
- **사용자 역할**: `user_role` 컬럼으로 역할 관리
- **Row Level Security**: 역할별 데이터 접근 제어 정책 적용
- **관리자 관계**: `manager_id`로 결재라인 구성
- **결재 권한**: `approval_authorities` 테이블로 세부 권한 관리

### 백엔드 API 구현
- **RPC Functions**: 
  - `get_all_users_for_admin`: 전체 사용자 조회 (수퍼어드민용)
  - `get_user_details_for_admin`: 사용자 상세 정보 조회
  - `update_user_for_admin`: 사용자 정보 수정
  - `cleanup_mock_users_for_admin`: 테스트 데이터 정리
- **API Routes**: `/lib/api/system-admin.ts`에서 시스템 관리 API 구현
- **인증 시스템**: bcrypt 패스워드 해싱, 이메일 없이 가입 가능

### 프론트엔드 UI 구현
- **사용자 관리**: `/system/users` 페이지에서 전체 직원 CRUD
- **역할 기반 네비게이션**: 권한에 따른 메뉴 차별화
- **회사-조직 연동**: 계층적 드롭다운 선택 시스템
- **실시간 데이터**: 사용자 정보 실시간 업데이트
- **조직 정보 표시**: 사용자 목록에서 소속 조직 표시

### 주요 구현된 기능
1. **사용자 등록**: 이메일 검증 없이 직접 계정 생성
2. **프로필 편집**: 모든 필드 수정 가능 (이름, 이메일, 전화번호, 회사, 조직, 역할)
3. **조직 관리**: 회사-조직 계층 구조 관리
4. **권한 제어**: 역할별 UI 접근 권한 차별화
5. **데이터 정리**: 테스트/목업 사용자 일괄 삭제 기능

---

이 자료는 "액세스 권한 구분, 기본 기능, 권한별 기능 차이"와 실제 구현 상태를 포함한 완전한 정리본입니다.
