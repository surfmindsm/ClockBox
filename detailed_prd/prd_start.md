# ClockBox - PRD 세부 문서 : 시작하기

## 1. 개요 (Overview)
ClockBox 서비스의 **최초 진입 및 온보딩 흐름**을 정의한다.  
사용자가 ClockBox에 가입하고, 회사를 생성하거나 합류하며, 관리자/직원 모드 전환을 통해 본격적인 근태·인력관리 기능을 활용할 수 있도록 한다.

### 목적
- 신규 사용자의 **빠른 적응**과 **서비스 이탈 최소화**
- **관리자/직원** 초기 역할 구분 명확화
- **회사 단위 데이터 관리 기반** 확보

---

## 2. 사용자 시나리오 (User Flow)

### 시나리오 A: 신규 회사 관리자
1. 앱/웹 접속 후 회원가입 (이메일, 비밀번호, 약관 동의)  
2. “새 회사 생성” 선택  
3. 회사명, 업종, 사업자등록번호 입력 → [저장]  
4. 자동으로 관리자 권한 부여  
5. 지점/부서 생성 및 직원 초대 진행  
6. 관리자 대시보드 진입  

### 시나리오 B: 직원 합류
1. 앱/웹 접속 후 회원가입  
2. 관리자 제공 합류코드 입력  
3. 회사에 자동 합류 → 직원 권한 부여  
4. 근무일정/출퇴근 화면 확인  

### 시나리오 C: 모드 전환
1. 관리자가 동시에 직원으로 등록된 경우  
2. 프로필 영역에서 **관리자 모드 ↔ 직원 모드** 전환 버튼 제공  
3. 전환 시 세션 유지 및 알림 동기화  

---

## 3. 기능 정의 (Feature Definition)
- **[FR-START-001] 회원가입**
- **[FR-START-002] 회사 생성**
- **[FR-START-003] 직장 합류**
- **[FR-START-004] 모드 전환**
- **[FR-START-005] 가이드 & FAQ**

---

## 4. UI/UX 요구사항
- 직관적 가입 프로세스, 소셜 로그인 지원  
- 회사 생성/합류 플로우는 3단계 이내 완료  
- 관리자 ↔ 직원 모드 전환 토글 버튼 제공  
- FAQ는 검색/카테고리 필터 지원  

---

## 5. 비즈니스 규칙
- 하나의 이메일은 1개 관리자 계정만 생성 가능  
- 직원은 여러 회사에 합류 가능 (겸직 허용)  
- 합류코드: 유효기간(7일), 사용 횟수 제한  
- 회사 삭제 불가 (비활성화만 가능)  

---

## 6. 데이터 모델링 (초안)
### users 테이블
| 컬럼명 | 타입 | 설명 |
|--------|------|------|
| id | PK | 사용자 ID |
| email | string | 로그인 이메일 |
| phone | string | 휴대폰 번호 |
| password_hash | string | 비밀번호 해시 |
| role | enum(admin, employee, both) | 기본 역할 |
| status | enum(active, inactive) | 계정 상태 |
| created_at | datetime | 가입일 |
| last_login_at | datetime | 최근 로그인 |

### companies 테이블
| 컬럼명 | 타입 | 설명 |
|--------|------|------|
| id | PK | 회사 ID |
| name | string | 회사명 |
| industry | string | 업종 |
| business_number | string | 사업자번호 |
| created_by | FK(users.id) | 생성자 |
| status | enum(active, inactive) | 상태 |

### memberships 테이블
| 컬럼명 | 타입 | 설명 |
|--------|------|------|
| id | PK | 멤버십 ID |
| user_id | FK(users.id) | 사용자 ID |
| company_id | FK(companies.id) | 회사 ID |
| role | enum(admin, employee) | 역할 |
| join_code | string | 합류코드 |
| status | enum(active, pending, rejected) | 상태 |
| joined_at | datetime | 합류일 |

---

## 7. 알림 및 연동
- 회원가입 완료 → 이메일 인증 발송  
- 회사 생성 완료 → 관리자에게 알림  
- 합류 요청 발생 → 관리자에게 푸시/메일 알림  
- 합류 승인/거절 결과 → 직원에게 알림  

---

## 8. 예외 및 에러 처리
| 케이스 | 조건 | 시스템 동작 | 사용자 메시지 |
|--------|------|------------|--------------|
| 이메일 중복 가입 | 동일 이메일 존재 | 가입 실패 | “이미 등록된 계정입니다.” |
| 이메일 미인증 | 인증 미완료 상태 | 로그인 차단 | “이메일 인증 후 이용 가능합니다.” |
| 합류코드 만료 | 유효기간 경과 | 합류 불가 | “코드가 만료되었습니다. 관리자에게 새 코드를 요청하세요.” |
| 합류코드 사용 초과 | 설정된 횟수 초과 | 합류 불가 | “코드 사용 횟수를 초과했습니다.” |
| 잘못된 합류코드 | 존재하지 않음 | 합류 불가 | “유효하지 않은 코드입니다.” |
| 권한 없는 모드 전환 | 관리자/직원 권한 미보유 | 전환 차단 | “이 모드에 접근할 권한이 없습니다.” |
| 회사 생성 중 네트워크 오류 | API 실패 | 재시도 요청 | “네트워크 오류가 발생했습니다. 다시 시도해주세요.” |

---

## 9. 연관성 (Dependency & Integration)
- **조직/지점 (prd_org.md)**: 회사 생성 시 기본 지점 자동 생성  
- **직원 (prd_employee.md)**: 합류코드 입력 → 직원 등록 프로세스 연동  
- **요청 (prd_request.md)**: 합류 요청 → 승인 프로세스와 연결  
- **메시지 (prd_message.md)**: 합류 승인/거절 알림 발송  

---

## 10. 성공 지표 (KPI)
- 신규 가입 후 **회사 생성 완료율 ≥ 80%**  
- 직원 초대 → 합류 완료율 **≥ 85%**  
- FAQ 조회 대비 고객센터 문의율 **20% 이상 감소**  
- 온보딩 완료 평균 시간 **5분 이내**
