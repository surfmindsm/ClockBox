# ClockBox - PRD 세부 문서 : 전자계약 (Contract)

## 1. 개요 (Overview)
ClockBox의 전자계약(Contract) 기능은 근로계약서, 연차촉진제 문서, 근무조건 변경 계약 등을 전자서명 기반으로 안전하게 관리한다.

### 목적
- 법적 효력 있는 전자계약 관리  
- 계약 이력 추적 및 보관  
- 관리자-직원 간 효율적인 계약 프로세스 제공  

---

## 2. 사용자 시나리오 (User Flow)

### 시나리오 A: 근로계약 체결
1. 관리자가 템플릿 선택 → 계약 생성  
2. 직원 지정 → 전송  
3. 직원이 앱에서 확인 후 전자서명  
4. 계약 완료 → 자동 보관 및 알림 발송  

### 시나리오 B: 계약 갱신
1. 계약 만료 30일 전 알림 발송  
2. 관리자가 계약 갱신 생성  
3. 직원 서명 후 갱신 완료  

---

## 3. 기능 정의 (Feature Definition)
- **[FR-CON-001] 계약 템플릿 관리 (마크다운/리치텍스트 지원)**  
- **[FR-CON-002] 계약 전송 (대상 직원 선택)**  
- **[FR-CON-003] 전자서명 (법적 효력 보장)**  
- **[FR-CON-004] 계약 갱신/변경 이력 관리**  
- **[FR-CON-005] 계약 보관/검색 (기간별/직원별)**  

---

## 4. UI/UX 요구사항
- 계약 작성 화면: 텍스트 편집기, 템플릿 불러오기  
- 직원 서명 화면: 모바일/웹 서명 지원  
- 계약 현황: 대기/완료/만료 구분  

---

## 5. 비즈니스 규칙
- 계약은 관리자만 전송 가능  
- 전자서명은 KISA 등 법적 효력 기준 충족 필요  
- 계약 이력은 최소 5년 보관  

---

## 6. 데이터 모델링 (초안)
### contracts 테이블
| 컬럼명 | 타입 | 설명 |
|--------|------|------|
| id | PK | 계약 ID |
| company_id | FK(companies.id) | 회사 |
| employee_id | FK(employees.id) | 직원 |
| template_id | FK(contract_templates.id) | 템플릿 |
| status | enum(pending, signed, expired) | 상태 |
| signed_at | datetime | 서명일 |
| created_at | datetime | 생성일 |

### contract_templates 테이블
| 컬럼명 | 타입 | 설명 |
|--------|------|------|
| id | PK | 템플릿 ID |
| company_id | FK(companies.id) | 회사 |
| name | string | 템플릿명 |
| content | text | 내용 |
| created_at | datetime | 생성일 |

---

## 7. 알림 및 연동
- 계약 전송 시 직원 알림  
- 서명 완료 시 관리자 알림  
- 외부 전자서명 서비스 연동 (e.g. DocuSign, KISA)  

---

## 8. 예외 및 에러 처리
| 케이스 | 조건 | 시스템 동작 | 사용자 메시지 |
|--------|------|------------|--------------|
| 미서명 계약 만료 | 기간 경과 | expired 처리 | “계약이 만료되었습니다.” |
| 템플릿 삭제 | 전송 시 템플릿 없음 | 전송 차단 | “계약 템플릿이 유효하지 않습니다.” |
| 서명 거부 | 직원이 거부 선택 | 계약 상태 rejected | “계약이 거부되었습니다.” |

---

## 9. 연관성 (Dependency & Integration)
- **직원 (prd_employee.md)**: 계약 대상 지정  
- **메시지 (prd_message.md)**: 계약 전송/완료 알림 발송  
- **회사설정 (prd_company.md)**: 계약 보관 정책 관리  

---

## 10. 성공 지표 (KPI)
- 계약 전송 → 서명 완료율 ≥ 95%  
- 계약 보관 검색 응답 속도 ≤ 3초  
