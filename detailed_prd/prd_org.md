# ClockBox - PRD 세부 문서 : 조직/지점

## 1. 개요 (Overview)
ClockBox의 조직/지점 관리 기능을 정의한다.  
회사 단위 하위 구조(본사, 지점, 부서 등)를 구성하고 출퇴근 장소를 지정할 수 있다.

### 목적
- 다양한 근무지 관리
- 지점 단위 근태 기록 및 통계 제공
- 관리자 권한 분산

---

## 2. 사용자 시나리오 (User Flow)
### 시나리오 A: 신규 지점 생성
1. 관리자가 회사 설정 > 지점 추가 선택
2. 지점명, 위치, 출퇴근 인증 방법 등록
3. 지점 관리자 권한 지정
4. 저장 후 직원 배정 가능

### 시나리오 B: 출퇴근 장소 등록
1. 관리자가 지점 설정 > 장소 등록
2. GPS 좌표/와이파이 SSID 입력
3. 직원 출퇴근 시 인증 가능

### 시나리오 C: 지점 관리자 지정
1. 특정 직원을 선택 후 “지점 관리자 권한 부여”
2. 지점별 근태/휴가 승인 권한 활성화

---

## 3. 기능 정의 (Feature Definition)
- **[FR-ORG-001] 지점 생성/수정/삭제**
- **[FR-ORG-002] 부서 관리**
- **[FR-ORG-003] 출퇴근 장소 등록 (GPS/WiFi)**
- **[FR-ORG-004] 지점 관리자 권한 부여**
- **[FR-ORG-005] 기본 지점 지정**

---

## 4. UI/UX 요구사항
- 지점 리스트 뷰 (검색/필터 가능)
- 지점 생성 시 위치 지도 입력 지원
- 직원 목록에서 지점 배정 UI 제공

---

## 5. 비즈니스 규칙
- 하나의 직원은 여러 지점에 배정 가능
- 지점 삭제 시 기록은 유지, 상태만 inactive
- 본조직은 항상 1개 이상 존재해야 함

---

## 6. 데이터 모델링 (초안)
### orgs 테이블
| 컬럼명 | 타입 | 설명 |
|--------|------|------|
| id | PK | 조직 ID |
| company_id | FK(companies.id) | 회사 ID |
| name | string | 조직명 |
| type | enum(head, branch, dept) | 본사/지점/부서 |
| parent_id | FK(orgs.id) | 상위 조직 |
| status | enum(active, inactive) | 상태 |
| created_at | datetime | 생성일 |

### org_locations 테이블
| 컬럼명 | 타입 | 설명 |
|--------|------|------|
| id | PK | 장소 ID |
| org_id | FK(orgs.id) | 조직 ID |
| gps_lat | float | 위도 |
| gps_lng | float | 경도 |
| wifi_ssid | string | 와이파이 SSID |
| created_at | datetime | 등록일 |

---

## 7. 알림 및 연동
- 지점 생성 시 관리자 알림
- 직원 배정 변경 시 직원 알림
- 외부 출입통제 시스템 연동 지원

---

## 8. 예외 및 에러 처리
| 케이스 | 조건 | 시스템 동작 | 사용자 메시지 |
|--------|------|------------|--------------|
| 중복 지점명 | 동일 회사 내 중복 | 생성 차단 | “이미 존재하는 지점명입니다.” |
| 본조직 삭제 | type=head 삭제 요청 | 차단 | “본조직은 삭제할 수 없습니다.” |
| 위치 정보 없음 | GPS/WiFi 미입력 | 저장 차단 | “출퇴근 인증 위치를 입력해주세요.” |
| 지점 관리자 미지정 | 지점에 관리자 없음 | 경고 | “지점 관리자를 반드시 지정해야 합니다.” |

---

## 9. 연관성 (Dependency & Integration)
- **시작하기 (prd_start.md)**: 회사 생성 시 본조직 자동 생성
- **출퇴근기록 (prd_attendance.md)**: 지점별 위치 기반 출퇴근 인증
- **직원 (prd_employee.md)**: 직원 지점 배정/관리
- **리포트 (prd_report.md)**: 지점별 근태 통계 제공

---

## 10. 성공 지표 (KPI)
- 지점 생성 후 직원 배정 완료율 ≥ 90%
- 출퇴근 기록의 지점 매칭 정확도 ≥ 99%
