# ClockBox - PRD 세부 문서 : 휴가

## 1. 개요 (Overview)
ClockBox의 휴가(Leave) 관리 기능을 정의한다.  
연차, 경조사, 보상휴가, 규칙 기반 휴가 자동 발생 및 승인 워크플로우 포함.

### 목적
- 근로기준법 준수 (연차 15일 이상, 촉진제 등)
- 직원 휴가 사용 투명성 보장
- 급여/정산과 연계

---

## 2. 사용자 시나리오 (User Flow)
### 시나리오 A: 연차 신청
1. 직원이 앱에서 휴가 신청
2. 관리자가 승인
3. 근무일정/출퇴근 기록에 반영

### 시나리오 B: 보상휴가 발생
1. 초과근무 발생
2. 관리자가 보상휴가 등록
3. 자동으로 잔여 휴가에 추가

### 시나리오 C: 규칙 기반 자동 발생
1. 매년 근속연수 기준으로 연차 자동 생성
2. 직원 잔여일수에 반영

---

## 3. 기능 정의 (Feature Definition)
- **[FR-LEAVE-001] 휴가 유형/그룹 관리**
- **[FR-LEAVE-002] 규칙 기반 자동 발생**
- **[FR-LEAVE-003] 보상휴가 등록**
- **[FR-LEAVE-004] 신청/승인/반려 워크플로우**
- **[FR-LEAVE-005] 휴가 캘린더/통계**

---

## 4. UI/UX 요구사항
- 달력 뷰에서 신청 가능
- 잔여일수 표시
- 승인 대기/거절 표시

---

## 5. 비즈니스 규칙
- 연차 발생: 근속 1년차 15일, 이후 매년 1일 증가
- 보상휴가는 1년 내 소멸
- 휴가와 근무일정 중복 불가

---

## 6. 데이터 모델링 (초안)
### leaves 테이블
| 컬럼명 | 타입 | 설명 |
|--------|------|------|
| id | PK | 휴가 ID |
| employee_id | FK(employees.id) | 직원 |
| type | enum(annual, reward, special) | 유형 |
| start_date | datetime | 시작일 |
| end_date | datetime | 종료일 |
| status | enum(pending, approved, rejected) | 상태 |
| created_at | datetime | 신청일 |

---

## 7. 알림 및 연동
- 신청/승인/반려 시 푸시 알림
- 연차 자동 발생 시 알림
- 급여 정산과 연동

---

## 8. 예외 및 에러 처리
| 케이스 | 조건 | 시스템 동작 | 사용자 메시지 |
|--------|------|------------|--------------|
| 잔여일 부족 | 휴가일수 > 잔여일 | 차단 | “잔여 연차가 부족합니다.” |
| 중복 신청 | 동일 기간 휴가 존재 | 차단 | “이미 휴가가 신청된 기간입니다.” |
| 승인 지연 | 7일 이상 미승인 | 자동 알림 | “승인이 지연되고 있습니다.” |

---

## 9. 연관성 (Dependency & Integration)
- **근무일정 (prd_schedule.md)**: 일정과 휴가 충돌 검증
- **출퇴근기록 (prd_attendance.md)**: 휴가일 출근 기록 방지
- **정산 (prd_payroll.md)**: 유급/무급 휴가 급여 반영
- **리포트 (prd_report.md)**: 휴가 사용 통계 제공

---

## 10. 성공 지표 (KPI)
- 휴가 승인 평균 소요 시간 ≤ 2일
- 휴가 발생/차감 정확도 ≥ 99%
